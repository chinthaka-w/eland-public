<app-last-remark *ngIf="showLastRemark" [workflow]="workflow.FOLIO_REQUEST_CORRECTION" [requestId]="reqId">
</app-last-remark>
<form class="form-horizontal" [formGroup]="reqForCorrectionForm">

  <div class="pg-inner-row mb-20">
    <div class="pg-inner-col">
      <div class="default-input-wrapper full-row m0">
        <label>{{'CITIZEN.CITIZEN_CORRECTION.NEAR_LAND_APPL'| translate}}<span class="redtxt">*</span></label>
        <div class="default-input-feild">
          <mat-select formControlName="landRegId" class="form-control"
            placeholder="{{'LAND_REGISTRY.SELECT'| translate}}">
            <mat-option [value]="item.landRegistryId" *ngFor="let item of landRegs">{{item.nameEng| listTranslate: item.nameSin: item.nameTam}}</mat-option>
          </mat-select>
          <mat-spinner *ngIf="!isLrLoaded && !isReadonly" [diameter]="16" class="spinner-input"></mat-spinner>
          <div *ngIf="landRegId.invalid && (landRegId.dirty || landRegId.touched)">
            <mat-error *ngIf="landRegId.errors.required" class="errors">{{'CITIZEN.CITIZEN_CORRECTION.PLS_FILL_FORM'| translate}}</mat-error>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="pg-inner-row mb-20">
    <div class="pg-inner-col">
      <div class="default-input-wrapper full-row">
        <label>{{'FOLIO_TYPE.FOLIO_NUM'| translate}}<span class="redtxt"> *</span></label>
        <div class="default-input-feild">
          <mat-form-field appearance="outline">
            <input matInput formControlName="folioNo" class="form-control">
          </mat-form-field>
          <div *ngIf="folioNo.invalid && (folioNo.dirty || folioNo.touched)">
            <mat-error *ngIf="folioNo.errors.required" class="errors">{{'CITIZEN.CITIZEN_CORRECTION.PLS_FILL_FORM'| translate}}</mat-error>
            <mat-error *ngIf="folioNo.errors.maxlength" class="errors">{{'VALIDATION.FOLIO_NO.INVALID_ERR'| translate}}</mat-error>
            <mat-error *ngIf="folioNo.errors.pattern" class="errors">{{'VALIDATION.FOLIO_NO.INVALID_ERR'| translate}}</mat-error>
          </div>
        </div>
      </div>
    </div>
    <div class="pg-inner-col">
      <div class="default-input-wrapper full-row">
        <label>{{'CITIZEN.CITIZEN_CORRECTION.DAYBOOK'| translate}}</label>
        <div class="default-input-feild">
          <mat-form-field appearance="outline">
            <input matInput formControlName="dayBookNo" class="form-control">
          </mat-form-field>
          <div *ngIf="dayBookNo.invalid && (dayBookNo.dirty || dayBookNo.touched)">
            <mat-error *ngIf="dayBookNo.errors.maxlength" class="errors">{{'CITIZEN.CITIZEN_CORRECTION.VALID_DAYBOOK'| translate}}</mat-error>
            <mat-error *ngIf="dayBookNo.errors.pattern" class="errors">{{'CITIZEN.CITIZEN_CORRECTION.VALID_DAYBOOK'| translate}}</mat-error>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="pg-inner-row mb-20">
    <div class="pg-inner-col">
      <div class="default-input-wrapper full-row">
        <label>{{'CITIZEN.CITIZEN_CORRECTION.DEED_NO'| translate}}</label>
        <div class="default-input-feild">
          <mat-form-field appearance="outline">
            <input matInput formControlName="deedNo" class="form-control">
          </mat-form-field>
          <div *ngIf="deedNo.invalid && (deedNo.dirty || deedNo.touched)">
            <mat-error *ngIf="(deedNo.errors.maxlength || deedNo.errors.pattern)" class="errors">{{'VALIDATION.DEED.DEED_INVALID_ERR'| translate}}</mat-error>
          </div>
        </div>
      </div>
    </div>
    <div class="pg-inner-col">
      <div class="default-input-wrapper full-row">
        <label>{{'CITIZEN.CITIZEN_CORRECTION.NOTARY_NAME'| translate}}</label>
        <div class="default-input-feild">
          <mat-form-field appearance="outline">
            <input matInput formControlName="notaryName" class="form-control">
          </mat-form-field>
          <div *ngIf="notaryName.invalid && (notaryName.dirty || notaryName.touched)">
            <mat-error *ngIf="notaryName.errors.pattern" class="errors">{{'VALIDATION.NAME_INVALID_ERR'| translate}}</mat-error>
            <mat-error *ngIf="notaryName.errors.maxlength" class="errors">{{'VALIDATION.NAME_INVALID_ERR'| translate}}</mat-error>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="pg-inner-row mb-20">
    <div class="pg-inner-col">
      <div class="default-input-wrapper full-row">
        <label>{{'CITIZEN.CITIZEN_CORRECTION.DEED_DATE'| translate}}</label>
        <div class="default-input-feild date-feild">
          <mat-form-field appearance="outline">
            <input matInput [matDatepicker]="picker" [max]="maxDate" formControlName="attestedDate"
              class="form-control">
            <mat-datepicker #picker></mat-datepicker>
          </mat-form-field>
          <button type="button" mat-raised-button (click)="picker.open()">
            <i class="material-icons">calendar_today</i>
          </button>
        </div>
      </div>
    </div>
    <div class="pg-inner-col">
      <div class="default-input-wrapper full-row">
        <label>{{'CITIZEN.CITIZEN_CORRECTION.NATURE_OF_CORRECTION'| translate}}<span class="redtxt"> *</span></label>
        <div class="default-input-feild">
          <mat-form-field appearance="outline">
            <textarea matInput formControlName="correctionNature" class="form-control"></textarea>
          </mat-form-field>
          <div *ngIf="correctionNature.invalid && (correctionNature.dirty || correctionNature.touched)">
            <mat-error *ngIf="correctionNature.errors.required" class="errors">{{'CITIZEN.CITIZEN_CORRECTION.PLS_FILL_FORM'| translate}}</mat-error>
            <mat-error *ngIf="correctionNature.errors.maxlength || correctionNature.errors.pattern" class="errors">{{'VALIDATION.SECTION35.NATURE_INVALID_ERR'| translate}}</mat-error>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="pg-inner-row">
    <div class="pg-inner-col">
      <div class="default-input-wrapper full-row">
        <label>{{'CITIZEN.CITIZEN_CORRECTION.CORRECTION'| translate}} <span class="redtxt"> *</span></label>
        <div class="default-input-feild">
          <mat-form-field appearance="outline">
            <textarea matInput formControlName="requestedCorrection" class="form-control"></textarea>
          </mat-form-field>
          <div *ngIf="requestedCorrection.invalid && (requestedCorrection.dirty || requestedCorrection.touched)">
            <mat-error *ngIf="requestedCorrection.errors.required" class="errors">{{'CITIZEN.CITIZEN_CORRECTION.PLS_FILL_FORM'| translate}}</mat-error>
            <mat-error *ngIf="requestedCorrection.errors.maxlength || requestedCorrection.errors.pattern" class="errors">{{'VALIDATION.SECTION35.CORRECTION_INVALID_ERR'| translate}}</mat-error>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="pg-inner-row" *ngIf="!isReadonly && newRequest">
    <div class="default-input-wrapper full-row">
      <div class="pg-inner-col">
        <button type="button" class="add-row" mat-flat-button (click)="onAddCorrection(editIndex)">
          {{!isEdit? ('BUTTONS.ADD'| translate): ('BUTTONS.EDIT_BUTTON'| translate)}} <i class="material-icons"> {{!isEdit? 'add_circle_outline': 'edit'}} </i>
        </button>
      </div>
    </div>
  </div>
  <div class="pg-inner-row mb-20" *ngIf="!isReadonly">
    <div class="default-input-wrapper full-row">
      <hr />
    </div>
  </div>
  <div class="pg-inner-row mb-20" *ngIf="!isReadonly && newRequest">
    <div class="mat-elevation-z8">
      <table mat-table [dataSource]="dataSource">
        <!-- Folio No Column -->
        <ng-container matColumnDef="folioNo">
          <th mat-header-cell *matHeaderCellDef> {{'FOLIO_TYPE.FOLIO_NUM'| translate}} </th>
          <td mat-cell *matCellDef="let element"> {{element.folioNo}} </td>
          <td mat-footer-cell *matFooterCellDef>
            <button *ngIf="correctionDetails.length>0" type="button" color="warn" class="add-row" mat-button
              (click)="onClearAll()">
              {{'CITIZEN.CITIZEN_CORRECTION.DLT_FORVR'| translate}} <i class="material-icons">delete_forever</i>
            </button>
          </td>
        </ng-container>

        <!-- Day book No Column -->
        <ng-container matColumnDef="dayBookNo">
          <th mat-header-cell *matHeaderCellDef> {{'CITIZEN.CITIZEN_CORRECTION.DAYBOOK'| translate}} </th>
          <td mat-cell *matCellDef="let element"> {{element.dayBookNo}} </td>
          <td mat-footer-cell *matFooterCellDef></td>
        </ng-container>

        <!-- Nature of correction Column -->
        <ng-container matColumnDef="correctionNature">
          <th mat-header-cell *matHeaderCellDef> {{'CITIZEN.CITIZEN_CORRECTION.NATURE_CORREC'| translate}} </th>
          <td mat-cell *matCellDef="let element"> {{element.correctionNature}} </td>
          <td mat-footer-cell *matFooterCellDef> </td>

        </ng-container>

        <!-- Requested correction Column -->
        <ng-container matColumnDef="requestedCorrection">
          <th mat-header-cell *matHeaderCellDef> {{'CITIZEN.CITIZEN_CORRECTION.REQ_CORE_MAD'| translate}} </th>
          <td mat-cell *matCellDef="let element"> {{element.requestedCorrection}} </td>
          <td mat-footer-cell *matFooterCellDef> </td>
        </ng-container>

        <!-- Action colum -->
        <ng-container matColumnDef="action">
          <th mat-header-cell *matHeaderCellDef> {{'COMMON.ACTION'| translate}} </th>
          <td mat-cell *matCellDef="let element; let i = index">
            <button type="button" class="add-row mr-5" mat-icon-button color="primary" (click)="onEdit(i)">
              <i class="material-icons">edit</i>
            </button>
            <button type="button" class="add-row mr-5" mat-icon-button color="warn" (click)="onClearItem(i)">
              <i class="material-icons">delete_outline</i>
            </button>
            <button type="button" class="add-row" mat-icon-button color="primary" (click)="onDocUpload(i)">
              <i class="material-icons">cloud_upload</i>
            </button>
          </td>
          <td mat-footer-cell *matFooterCellDef> </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        <tr mat-footer-row *matFooterRowDef="displayedColumns"></tr>
      </table>

      <!-- <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator> -->
    </div>

  </div>
  <!-- End of correction details -->
  <div class="separator">&nbsp;</div>
  <div class="pg-inner-row mb-0">
    <div class="pg-inner-col" *ngIf="!isReadonly">
      <div class="f-captcha">
        <re-captcha formControlName="recaptcha" class="form-control"></re-captcha>
      </div>
    </div>
    <div class="pg-inner-col right" *ngIf="!isReadonly">
      <button *ngIf="newRequest" [disabled]="isSave" type="button" mat-raised-button class="lg-button" (click)="onFormSubmit()">
        {{'BUTTONS.SUBMIT_BUTTON' | translate}}
        <mat-spinner *ngIf="isClick && isSave" [diameter]="16" class="spinner-inline"></mat-spinner>
      </button>
      <button *ngIf="!newRequest" [disabled]="isSave" type="button" mat-raised-button class="button" (click)="onFormSubmit()">
        {{'BUTTONS.UPDATE_BUTTON'| translate}}
        <mat-spinner *ngIf="isClick && isSave" [diameter]="16" class="spinner-inline"></mat-spinner>
      </button>
    </div>
  </div>

</form>
